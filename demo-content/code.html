<p>Here is some code. It's fairly meta.</p>

<div class="highlight highlight-javascript"><pre><span class="s1">'use strict'</span><span class="p">;</span>

<span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'kalmasNetApp.controllers'</span><span class="p">,</span> <span class="p">[])</span>
    <span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s1">'BlogCtrl'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'$scope'</span><span class="p">,</span> <span class="s1">'$routeParams'</span><span class="p">,</span> <span class="s1">'$location'</span><span class="p">,</span> <span class="s1">'BlogPosts'</span>
              <span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$routeParams</span><span class="p">,</span> <span class="nx">$location</span><span class="p">,</span> <span class="nx">BlogPosts</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">slug</span> <span class="o">=</span> <span class="nx">$routeParams</span><span class="p">.</span><span class="nx">slug</span><span class="p">;</span>

    <span class="c1">// Get a list of recent posts</span>
    <span class="nx">BlogPosts</span><span class="p">.</span><span class="nx">getPostsList</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">posts</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">posts</span><span class="p">;</span>
    <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">posts</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Then get this post</span>
      <span class="nx">BlogPosts</span><span class="p">.</span><span class="nx">getPostBySlug</span><span class="p">(</span><span class="nx">slug</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">post</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">post</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">){</span>
          <span class="nx">$location</span><span class="p">.</span><span class="nx">path</span><span class="p">(</span><span class="s1">'/blog/'</span> <span class="o">+</span> <span class="nx">posts</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">slug</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">$scope</span><span class="p">.</span><span class="nx">post</span> <span class="o">=</span> <span class="nx">post</span><span class="p">;</span>
          <span class="nx">$scope</span><span class="p">.</span><span class="nx">posts</span> <span class="o">=</span> <span class="nx">posts</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">});</span>


<span class="p">}]);</span>
</pre></div></body></html>